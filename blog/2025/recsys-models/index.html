<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Recsys Models | Michael Yu </title> <meta name="author" content="Michael Yu"> <meta name="description" content="Popular recsys models / algorithms"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://michaelc-yu.github.io/blog/2025/recsys-models/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Michael</span> Yu </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/notes/index.html">notes </a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">research </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Recsys Models</h1> <p class="post-meta"> Created in July 20, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/machine-learning"> <i class="fa-solid fa-hashtag fa-sm"></i> machine-learning</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>List of common and popular models and algorithms used in recommendation systems.</p> <h2 id="sequential-recommendation"><b>Sequential Recommendation</b></h2> <h4 id="gru4rec"><b>GRU4Rec</b></h4> <p>Many e-commerce recommender systems or news and media sites don’t track user behavior across different sessions for privacy concerns and because it’s difficult and unreliable with cookies and browser fingerprinting. Introduce session-based recommendation, where you don’t know the user’s long-term profile — you only observe the current session. GRU4Rec applies the GRU-based RNN for session-based recommendations. The model tries to capture short-term intent within the session.</p> <h4 id="sasrec"><b>SASRec</b></h4> <p>Self-Attentive Sequential Recommendation. Proposed in 2018 and one of the first works to apply the Transformer architecture (self-attention) to the sequential recommendation problem. It formulates sequential recommendation as next-item prediction, given a user’s past interaction sequence. Self-attention helps capture both short and long-term preferences much better and more parallelizable than previous approaches like RNNs or Markov chains. It outperforms GRU4Rec on several datasets including MovieLens. It uses only the Transformer encoder stack. SASRec can process the entire concatenated history of a user — including multiple sessions — and predict the next item.</p> <p><br><br></p> <h2 id="multi-armed-bandits--exploration-exploitation"><b>Multi-Armed Bandits / Exploration-Exploitation</b></h2> <p>Multi-armed bandits (bandits) are a type of reinforcement learning. Their advantages over batch machine learning and A/B testing methods include continuously learning and adapting recommendations without the need for extensive data collection or offline model training. Usually performs better in situations with limited data or in cold-start scenarios.</p> <h4 id="epsilon-greedy"><b>Epsilon-Greedy</b></h4> <p>With probability ϵ, you pick a random arm (explore), and with probability 1 - ϵ, you pick the arm with the highest estimated mean reward (exploit). Note: this is not a contextual bandit approach (you don’t observe the context for each decision). ϵ parameter controls the balance between exploration and exploitation. A higher ϵ means more exploration, while a lower ϵ means more exploitation. A strategy is to decrease the value of ϵ over time and allow for more exploitation.</p> <h4 id="linucb"><b>LinUCB</b></h4> <p>These algorithms, in each trial, estimate both the mean payoff of each arm as well as a corresponding confidence interval. They then select the arm that achieves the highest upper confidence bound.<br></p> \[\begin{array}{l} \textbf{For each arm } a: \\ \quad A_a \leftarrow I_d \\ \quad b_a \leftarrow 0_d \\[1em] \textbf{For each round } t: \\ \quad \text{Observe context vector } x_{a,t} \text{ for all arms } a \\[0.5em] \quad \textbf{For each arm } a: \\ \quad\quad \hat{\theta}_a \leftarrow A_a^{-1} b_a \\ \quad\quad \text{mean_reward}_a \leftarrow x_{a,t}^\top \hat{\theta}_a \\ \quad\quad \text{uncertainty}_a \leftarrow \sqrt{x_{a,t}^\top A_a^{-1} x_{a,t}} \\ \quad\quad p_a \leftarrow \text{mean_reward}_a + \alpha \cdot \text{uncertainty}_a \\[1em] \quad \text{Choose arm } a_t \leftarrow \arg\max_a p_a \\[0.5em] \quad \text{Observe reward } r_t \\[0.5em] \quad \textbf{Update:} \\ \quad\quad A_{a_t} \leftarrow A_{a_t} + x_{a_t} x_{a_t}^\top \\ \quad\quad b_{a_t} \leftarrow b_{a_t} + r_t x_{a_t} \\ \end{array}\] <p>Notes:<br> -we assume each arm has its own independent linear model<br> -pₐ is the upper confidence bound for arm a at time t<br> -\(\alpha\) is the exploration hyperparameter<br> -\(x_{a,t}\) is the context vector given by the problem, per arm, per round. Ex. Arms = articles. At time t, each article has context vector describing user profile, article topic, recency, etc.<br> -\(x_{a,t}^\top \hat{\theta}_a\) is best estimate of expected reward for arm a<br> -\(\sqrt{x_{a,t}^\top A_a^{-1} x_{a,t}}\) is how uncertain we are about this estimate (standard error)<br></p> <h4 id="thompson-sampling"><b>Thompson Sampling</b></h4> <p>Thompson Sampling is a Bayesian algorithm. In each round, parameters are sampled from the posterior and an action is chosen that maximizes expected reward given the sampled parameters and current context. Observe the reward and update the posterior for the arm that was just chosen.</p> \[\begin{aligned} &amp;\text{For each arm } a \in \{1, \dots, K\}, \text{ assume:} \\ &amp;\quad \theta_a \sim \text{Beta}(\alpha_a, \beta_a) \\ &amp;\quad r_t \sim \text{Bernoulli}(\theta_{a_t}) \\\\ &amp;\text{At each time step } t: \\ &amp;\quad \text{Sample } \hat{\theta}_a \sim \text{Beta}(\alpha_a, \beta_a), \quad \forall a \in \{1, \dots, K\} \\ &amp;\quad \text{Select arm } a_t = \arg\max_a \hat{\theta}_a \\ &amp;\quad \text{Play arm } a_t \text{ and observe reward } r_t \in \{0, 1\} \\\\ &amp;\text{Update the posterior:} \\ &amp;\quad \alpha_{a_t} \leftarrow \alpha_{a_t} + r_t \\ &amp;\quad \beta_{a_t} \leftarrow \beta_{a_t} + (1 - r_t) \end{aligned}\] <p><br><br></p> <h2 id="wide--deep-architectures"><b>Wide &amp; Deep Architectures</b></h2> <h4 id="wide--deep"><b>Wide &amp; Deep</b></h4> <p>Wide &amp; Deep learning trains wide linear models and deep neural networks together to combine the benefits of memorization (wide part) and generalization (deep part) for recommender systems.<br> The wide component’s feature crosses are interpretable and effective and capturing known, explicit relationships. However, it also requires manual feature engineering to create effective crossing of features. For example (gender x city) or (item category x user membership).<br></p> <p>The deep component is good at learning complex patterns. No manual feature engineering is required here since the model automatically learns through non-linear activation functions.<br></p> <p>The output of both wide and deep components can be either scalar (solving binary classification problem like predicting CTR) or a vector of logits (solving a multi-class classification problem). Outputs of both components are combined to make final predictions. Can combine through either summing or concatenating and then feeding through a final dense layer.</p> <h4 id="deepfm"><b>DeepFM</b></h4> <p>Combines factorization machines (FM) for feature interactions (memorizations) and deep neural networks for generalization. Similar to Wide &amp; Deep, but with factorization machines you don’t need to manually craft cross features since FM does that for you. So it’s just like Wide &amp; Deep with ability to memorize and generalize patterns but wide part is implemented with factorization machine.<br><br> Factorization machine formula:<br><br> \(\hat{y}(x) = w_0 + \sum_{i=1}^{n} w_i x_i + \sum_{i=1}^{n} \sum_{j=i+1}^{n} \langle \mathbf{v}_i, \mathbf{v}_j \rangle x_i x_j\) <br><br> -\(x_i\) are the input features<br> -\(w_0\) is a global bias<br> -\(\mathbf{v}_i\) is an embedding vector for feature i<br> <br> FMs generalize matrix factorization to work with any kind of feature data, not just user and item IDs. FMs give pairwise interactions.</p> <p><br><br></p> <h2 id="classic-methods"><b>Classic Methods</b></h2> <h4 id="matrix-factorization-mf"><b>Matrix Factorization (MF)</b></h4> <p>Simple embedding model that decomposes a sparse user-item feedback matrix into the product of two dense lower-dimensional matrices. One is the user embedding matrix and the other is the item embedding matrix. Their product approximates the sparse rating matrix. This way, we can learn embedding for users and items.</p> <h4 id="neural-collaborative-filtering-ncf"><b>Neural Collaborative Filtering (NCF)</b></h4> <p>Replaces the dot product in matrix factorization with neural networks. We concatenate user and item vector embeddings and feed into MLP which predicts something like click or no click, rating, etc. We train on interaction data; the user and item embeddings are learned during training and they are initially random vectors. Using neural networks instead of dot product (as in matrix factorization) allows nonlinearity and ability to model more complex patterns.</p> <p><br><br></p> <h2 id="graph-based-methods"><b>Graph-Based Methods</b></h2> <h4 id="gcn-based-recsys"><b>GCN-based RecSys</b></h4> <p>Graph Convolutional Networks learn from data where the relationships between elements are represented as a graph with nodes and edges. A GCN layer updates each node’s representation by aggregating features from its neighbors:</p> <p>-message passing: each node gathers information from its neighbors</p> <p>-aggregation: the collected features are combined (usually via summation, mean, or max)</p> <p>-transformation: the aggregated information is passed through a neural network layer (e.g., a linear transformation + activation)</p> <p>Stacking multiple convolutions allows information flow across far reaches of graph</p> <p><br></p> <h4 id="pinsage"><b>PinSage</b></h4> <p>PinSage, released in 2018, is a highly-scalable (operating on a massive graph with three billion nodes and 18 billion edges) graph convolutional network framework developed and deployed at Pinterest.</p> <p>While previous GCN approaches use k-hop graph neighborhoods, PinSage defines neighborhoods based on importance of nearby nodes. The neighborhoods of a node are the T nodes that exert the most influence on that node.</p> <h5 id="key-points-about-pinsage-"><b>Key points about PinSage: </b></h5> <p>-simulate random walks starting from node u and compute the L1-normalized visit count of nodes visited by the random walk. The neighborhood of u is then defined as the top T nodes with the highest normalized visit counts with respect to node u</p> <p>-stacking multiple convolutions on top of each other to gain more information about the local graph structure around node u. Layer 0 representations are equal to the input node features, and all other layers depend on the output from the previous layer</p> <p>-train PinSage using max-margin ranking loss: maximize inner product of positive pairs (q, i) (item i is a good recommendation candidate for query q), and minimize inner product of negative pairs, such that inner product of negative examples is smaller than that of positive examples by some pre-defined margin</p> <p>-train with multiple GPUs via data parallelism and large batch sizes</p> <p>-use re-indexing technique to create a sub-graph G’ = (V’, E’) containing nodes and their neighborhood which will be involved in the computation of the current minibatch. Otherwise GPU accsesing data in CPU for neighborhood and feature information is slow and inefficient</p> <p>-negative sampling: random selection of some negative pairs to push them apart when training. In PinSage training, they sample a set of 500 negative items that’s shared by all training examples in each minibatch to speed up training. Also uses hard negative examples, which are somewhat related items but not as related as positive pair, to make model learn at finer granularity</p> <p>-since PinSage itself doesn’t compute embeddings (it only trains a GCN to generate an embedding function given a node’s features and neighborhood information), it needs an efficient way to actually compute the embedding vectors. It does so via MapReduce</p> <p>-given a query q, we can directly recommend items whose embeddings are the K-nearest neighbors of that embedding, based on the embeddings computed by PinSage. Approximate KNN can be obtained efficiently via locality sensitive hashing. See here: <a href="https://en.wikipedia.org/wiki/Locality-sensitive_hashing" rel="external nofollow noopener" target="_blank">Locality sensitive hashing wikipedia</a></p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Michael Yu. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> </body> </html>